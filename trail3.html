<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéπ Enhanced Keyboard Pressure Tracker</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>üéπ Enhanced Keyboard Pressure Tracker </header>
        
        <main>
            <p class="intro">Start typing in the text area below to discover your unique typing style!</p>
            
            <textarea class="typing-area" placeholder="Click here and start typing to analyze your keyboard pressure..."></textarea>
            
            <div id="result">
                <span class="emoji">‚å®Ô∏è</span>
                <div>Ready to analyze your typing!</div>
            </div>
            
            <div id="lastKey">Press any key to begin...</div>
            
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number" id="counter">0</div>
                    <div class="stat-label">Keys Pressed</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="avgTime">0</div>
                    <div class="stat-label">Avg Time (ms)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="wpm">0</div>
                    <div class="stat-label">WPM</div>
                </div>
            </div>
        </main>

        <footer>Made with ‚ù§Ô∏è by Parvathy and Malavika</footer>
    </div>

    <!-- Sound Files -->
    <audio id="soft1" src="baby.mp3"></audio>
    <audio id="soft2" src="baby.mp3"></audio>
    <audio id="smash1" src="smasher.mp3"></audio>
    <audio id="smash2" src="smasher.mp3"></audio>
    <audio id="normal" src="normal.mp3"></audio>

    <script>
        let keyPressTimes = {};
        let totalKeys = 0;
        let totalPressTime = 0;
        let startTime = null;
        let wordCount = 0;

        let keystrokeCount = parseInt(localStorage.getItem("keystrokeCount")) || 0;
        document.getElementById("counter").textContent = keystrokeCount;

        document.addEventListener("keydown", function () {
            keystrokeCount++;
            localStorage.setItem("keystrokeCount", keystrokeCount);
            document.getElementById("counter").textContent = keystrokeCount;
        });

        function playRandomSound(sounds) {
            let soundId = sounds[Math.floor(Math.random() * sounds.length)];
            let audio = document.getElementById(soundId);
            if (audio) {
                audio.currentTime = 0; 
                audio.play().catch(e => console.log('Audio play failed:', e));
            }
        }

        function updateStats() {
            document.getElementById('counter').textContent = totalKeys;
            document.getElementById('avgTime').textContent = totalKeys > 0 ? Math.round(totalPressTime / totalKeys) : 0;
            
            if (startTime) {
                const minutesPassed = (Date.now() - startTime) / 60000;
                const wpm = Math.round(wordCount / minutesPassed) || 0;
                document.getElementById('wpm').textContent = wpm;
            }
        }

        function countWords(text) {
            return text.trim().split(/\s+/).filter(word => word.length > 0).length;
        }

        function getTypingStyle(duration) {
            if (duration < 100) return { type: 'lightning', emoji: '‚ö°', color: '#ffd700', description: 'Lightning Fast!', sounds: ['soft1', 'soft2'] };
            if (duration < 150) return { type: 'soft', emoji: 'üçº', color: '#c2f0c2', description: 'Soft Baby Typing', sounds: ['soft1', 'soft2'] };
            if (duration < 250) return { type: 'normal', emoji: 'üòä', color: '#cce0ff', description: 'Perfect Rhythm', sounds: ['normal'] };
            if (duration < 350) return { type: 'heavy', emoji: 'üî®', color: '#ffcc99', description: 'Heavy Handed', sounds: ['normal'] };
            return { type: 'smash', emoji: 'üí•', color: '#ffb3b3', description: 'Keyboard Destroyer!', sounds: ['smash1', 'smash2'] };
        }

        document.addEventListener("keydown", function(event) {
            keyPressTimes[event.key] = Date.now();
            if (!startTime) startTime = Date.now();
        });

        document.addEventListener("keyup", function(event) {
            if (!keyPressTimes[event.key]) return;
            
            const pressDuration = Date.now() - keyPressTimes[event.key];
            const resultDiv = document.getElementById("result");
            const lastKeyDiv = document.getElementById("lastKey");
            
            totalKeys++;
            totalPressTime += pressDuration;
            
            const typingArea = document.querySelector('.typing-area');
            if (typingArea) wordCount = countWords(typingArea.value);
            
            updateStats();
            
            const keyDisplay = event.key === ' ' ? 'Space' : event.key.length === 1 ? event.key.toUpperCase() : event.key;
            lastKeyDiv.innerHTML = `Last key: <b>${keyDisplay}</b> (${pressDuration}ms)`;
            
            const style = getTypingStyle(pressDuration);
            resultDiv.innerHTML = `
                <span class="emoji">${style.emoji}</span>
                <div>${style.description}</div>
                <div style="font-size: 1rem; opacity: 0.8;">${pressDuration}ms</div>
            `;
            
            document.body.style.background = `linear-gradient(135deg, ${style.color}, #764ba2)`;
            
            if (style.type === 'smash') {
                resultDiv.classList.add('shake');
                setTimeout(() => resultDiv.classList.remove('shake'), 500);
            } else if (style.type === 'lightning') {
                resultDiv.classList.add('glow');
                setTimeout(() => resultDiv.classList.remove('glow'), 500);
            }
            
            playRandomSound(style.sounds);
            
            setTimeout(() => {
                document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
            }, 600);
            
            delete keyPressTimes[event.key];
        });

        window.addEventListener('load', function() {
            document.querySelector('.typing-area').focus();
        });
    </script>
</body>
</html>
